{"paragraphs":[{"text":"//Using of spark context (sc)\n\nval textfile=sc.textFile(sys.env(\"ZEPPELIN_HOME\")+\"/readme.md\")\nval counts = textfile.flatMap(line => line.split(\" \"))\n                 .map(word => (word, 1))\n                 .reduceByKey(_ + _)\nval top15=counts.sortBy(_._2, false)take(15)\ntop15.foreach(println)","dateUpdated":"Jun 25, 2016 11:50:10 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1453617564972_1076123845","id":"20160124-063924_1251102938","result":{"code":"SUCCESS","type":"TEXT","msg":"textfile: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[3] at textFile at <console>:34\ncounts: org.apache.spark.rdd.RDD[(String, Int)] = ShuffledRDD[6] at reduceByKey at <console>:36\ntop15: Array[(String, Int)] = Array((\"\",159), (```,20), (the,12), (mvn,12), (you,11), (package,10), (version,10), (to,10), (and,10), (clean,9), (can,8), (with,8), (Spark,8), (#,8), (export,7))\n(,159)\r\n(```,20)\r\n(the,12)\r\n(mvn,12)\r\n(you,11)\r\n(package,10)\r\n(version,10)\r\n(to,10)\r\n(and,10)\r\n(clean,9)\r\n(can,8)\r\n(with,8)\r\n(Spark,8)\r\n(#,8)\r\n(export,7)\r\n"},"dateCreated":"Jan 24, 2016 6:39:24 AM","dateStarted":"Jun 25, 2016 11:50:10 PM","dateFinished":"Jun 25, 2016 11:50:19 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:609"},{"text":"//Using of spark sql context (sqlContext)\n\nval df=counts.toDF(\"word\",\"count\")\ndf.registerTempTable(\"wordCount\")\nval words = sqlContext.sql(\"SELECT word,count FROM wordCount WHERE count >= 4 AND count <= 10\")\n\nwords.show()","dateUpdated":"Jan 24, 2016 6:45:30 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1453617641059_-2013551029","id":"20160124-064041_2022971764","result":{"code":"SUCCESS","type":"TEXT","msg":"df: org.apache.spark.sql.DataFrame = [word: string, count: int]\nwords: org.apache.spark.sql.DataFrame = [word: string, count: int]\n+--------------------+-----+\n|                word|count|\n+--------------------+-----+\n|             package|   10|\n|              export|    7|\n|             version|   10|\n|               build|    7|\n|./conf/zeppelin-e...|    4|\n|                  is|    5|\n|            profiles|    6|\n|                 set|    4|\n|                ####|    5|\n|                 can|    8|\n|             apt-get|    5|\n|                with|    8|\n|            specific|    4|\n|         Interpreter|    4|\n|                MapR|    4|\n|                   *|    6|\n|               spark|    4|\n|              -Pyarn|    4|\n|                sudo|    7|\n|                  To|    4|\n+--------------------+-----+\nonly showing top 20 rows\n\r\n"},"dateCreated":"Jan 24, 2016 6:40:41 AM","dateStarted":"Jan 24, 2016 6:45:30 AM","dateFinished":"Jan 24, 2016 6:45:31 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:610"},{"text":"%sql\nSELECT word,count FROM wordCount WHERE count >= 4 AND count <= 10 order by count","dateUpdated":"Jun 26, 2016 10:57:52 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1453617718583_1651721880","id":"20160124-064158_910376568","result":{"code":"SUCCESS","type":"TABLE","msg":"word\tcount\nInterpreter\t4\nset\t4\nspark\t4\nspecific\t4\n./conf/zeppelin-env.sh\t4\nby\t4\nsupport\t4\n-Pspark-1.5\t4\nZeppelin\t4\n-Phadoop-2.4\t4\n-Pyarn\t4\nHadoop\t4\n(optional)\t4\nMapR\t4\nTo\t4\n###\t5\napt-get\t5\non\t5\nis\t5\nor\t5\n####\t5\nbe\t5\nfor\t5\nIf\t5\nprofiles\t6\n#####\t6\n*\t6\ninstall\t6\n-DskipTests\t6\na\t6\nbuild\t7\nof\t7\nexport\t7\nsudo\t7\ncan\t8\nwith\t8\n#\t8\nSpark\t8\nclean\t9\npackage\t10\nversion\t10\nto\t10\nand\t10\n","comment":"","msgTable":[[{"key":"count","value":"Interpreter"},{"key":"count","value":"4"}],[{"value":"set"},{"value":"4"}],[{"value":"spark"},{"value":"4"}],[{"value":"specific"},{"value":"4"}],[{"value":"./conf/zeppelin-env.sh"},{"value":"4"}],[{"value":"by"},{"value":"4"}],[{"value":"support"},{"value":"4"}],[{"value":"-Pspark-1.5"},{"value":"4"}],[{"value":"Zeppelin"},{"value":"4"}],[{"value":"-Phadoop-2.4"},{"value":"4"}],[{"value":"-Pyarn"},{"value":"4"}],[{"value":"Hadoop"},{"value":"4"}],[{"value":"(optional)"},{"value":"4"}],[{"value":"MapR"},{"value":"4"}],[{"value":"To"},{"value":"4"}],[{"value":"###"},{"value":"5"}],[{"value":"apt-get"},{"value":"5"}],[{"value":"on"},{"value":"5"}],[{"value":"is"},{"value":"5"}],[{"value":"or"},{"value":"5"}],[{"value":"####"},{"value":"5"}],[{"value":"be"},{"value":"5"}],[{"value":"for"},{"value":"5"}],[{"value":"If"},{"value":"5"}],[{"value":"profiles"},{"value":"6"}],[{"value":"#####"},{"value":"6"}],[{"value":"*"},{"value":"6"}],[{"value":"install"},{"value":"6"}],[{"value":"-DskipTests"},{"value":"6"}],[{"value":"a"},{"value":"6"}],[{"value":"build"},{"value":"7"}],[{"value":"of"},{"value":"7"}],[{"value":"export"},{"value":"7"}],[{"value":"sudo"},{"value":"7"}],[{"value":"can"},{"value":"8"}],[{"value":"with"},{"value":"8"}],[{"value":"#"},{"value":"8"}],[{"value":"Spark"},{"value":"8"}],[{"value":"clean"},{"value":"9"}],[{"value":"package"},{"value":"10"}],[{"value":"version"},{"value":"10"}],[{"value":"to"},{"value":"10"}],[{"value":"and"},{"value":"10"}]],"columnNames":[{"name":"word","index":0,"aggr":"sum"},{"name":"count","index":1,"aggr":"sum"}],"rows":[["Interpreter","4"],["set","4"],["spark","4"],["specific","4"],["./conf/zeppelin-env.sh","4"],["by","4"],["support","4"],["-Pspark-1.5","4"],["Zeppelin","4"],["-Phadoop-2.4","4"],["-Pyarn","4"],["Hadoop","4"],["(optional)","4"],["MapR","4"],["To","4"],["###","5"],["apt-get","5"],["on","5"],["is","5"],["or","5"],["####","5"],["be","5"],["for","5"],["If","5"],["profiles","6"],["#####","6"],["*","6"],["install","6"],["-DskipTests","6"],["a","6"],["build","7"],["of","7"],["export","7"],["sudo","7"],["can","8"],["with","8"],["#","8"],["Spark","8"],["clean","9"],["package","10"],["version","10"],["to","10"],["and","10"]]},"dateCreated":"Jan 24, 2016 6:41:58 AM","dateStarted":"Jan 24, 2016 6:45:35 AM","dateFinished":"Jan 24, 2016 6:45:35 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:611"},{"text":"%pyspark  \nimport pandas as pd\nimport numpy as np\npdf = pd.DataFrame(np.random.randint(0,50,size=(5, 4)), columns=list('ABCD'))\nprint(pdf)\ndf=sqlContext.createDataFrame(pdf)\nprint(df.take(3))","dateUpdated":"Jan 24, 2016 6:45:38 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1453617739193_1265834057","id":"20160124-064219_1476097879","result":{"code":"SUCCESS","type":"TEXT","msg":"    A   B   C   D\n0  11  22  48  24\n1  35  46  16  49\n2  31  39   5  25\n3   2  45  24   8\n4   5  29   6  22\n[Row(A=11, B=22, C=48, D=24), Row(A=35, B=46, C=16, D=49), Row(A=31, B=39, C=5, D=25)]\n"},"dateCreated":"Jan 24, 2016 6:42:19 AM","dateStarted":"Jan 24, 2016 6:45:38 AM","dateFinished":"Jan 24, 2016 6:45:41 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:612"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1453617762871_451736033","id":"20160124-064242_1876064050","dateCreated":"Jan 24, 2016 6:42:42 AM","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:613"}],"name":"Spark Example","id":"2BBH2GB4W","angularObjects":{"2BA7S2E48":[],"2BC2RDM3Z":[],"2B9PNW7QW":[],"2BAGXS8NV":[],"2B9MGWSGW":[],"2BA2GWURV":[],"2BCFANQAD":[],"2BBY1VZKN":[],"2B8T3BBNE":[],"2BBE56WMD":[],"2BATDWABB":[],"2BB5CMJNN":[],"2BAMR2KM4":[],"2B9EVBEED":[]},"config":{"looknfeel":"default"},"info":{}}